/**
 * \file datamarinerviking.cpp
 * \brief Implements the martian atmosphere during mariner and viking conditions
 * Copyright G Gronoff Nov 2009
 * Last Modification $Id: datamarinerviking.cpp 863 2010-01-22 22:13:55Z gronoff $
 */



#include "datamarinerviking.hpp"
using namespace std;
namespace MarsData
{

	/**
	 * Conditions for the mariner landing
	 * altitude, CO2, N2, CO, O, O2, H, Tn
	 *
	 */
	double MarinerData[64*8] =
	{
		100.000000,3.48766837E+12,1.04172249E+11,1.20963410E+10,8.06530304E+09,1.25404129E+10,3.63658575E+06,1.29969727E+02,
		102.587570,2.39918567E+12,7.30531512E+10,9.91793766E+09,6.81143296E+09,8.70887834E+09,3.04815375E+06,1.29587997E+02,
		105.242096,1.62959314E+12,5.05048392E+10,7.97423360E+09,5.73854208E+09,5.97935616E+09,2.53576250E+06,1.29421387E+02,
		107.965302,1.09346482E+12,3.44160051E+10,6.26595533E+09,4.81994342E+09,4.05996928E+09,2.09378100E+06,1.29635086E+02,
		110.759026,7.25992079E+11,2.31339520E+10,4.83919923E+09,4.03445069E+09,2.72936243E+09,1.71725862E+06,1.30429184E+02,
		113.624992,4.78299128E+11,1.53693440E+10,3.72890675E+09,3.36488525E+09,1.82041024E+09,1.40097375E+06,1.32044693E+02,
		116.565117,3.13956794E+11,1.01260749E+10,2.93040998E+09,2.79668736E+09,1.20807334E+09,1.13906088E+06,1.34773895E+02,
		119.581314,2.06354530E+11,6.64934349E+09,2.37446835E+09,2.31696538E+09,8.00371776E+08,9.25063188E+05,1.38974548E+02,
		122.675560,1.36522850E+11,4.38116096E+09,1.95969267E+09,1.91378765E+09,5.31060288E+08,7.52126500E+05,1.45084579E+02,
		125.849869,9.13003479E+10,2.92067021E+09,1.61444147E+09,1.57582746E+09,3.53603648E+08,6.13283062E+05,1.53623047E+02,
		129.106384,6.17936609E+10,1.98800230E+09,1.31186752E+09,1.29234944E+09,2.36185504E+08,5.01748125E+05,1.65133896E+02,
		132.447098,4.21412864E+10,1.39250035E+09,1.04774016E+09,1.05362176E+09,1.57691120E+08,4.11240531E+05,1.79951950E+02,
		135.874252,2.85790454E+10,1.00618976E+09,8.21082560E+08,8.51653376E+08,1.04509816E+08,3.36327719E+05,1.97513168E+02,
		139.390091,1.89999227E+10,7.49365376E+08,6.32707136E+08,6.83398912E+08,6.86058160E+07,2.74349531E+05,2.14976929E+02,
		142.996887,1.28400087E+10,5.89244480E+08,4.94684224E+08,5.52186624E+08,4.64268000E+07,2.28856422E+05,2.29968704E+02,
		146.697037,8.84228403E+09,4.82570208E+08,3.92918240E+08,4.45153888E+08,3.24329040E+07,1.94814641E+05,2.42693146E+02,
		150.492981,6.20472064E+09,4.03762304E+08,3.15936128E+08,3.57240032E+08,2.31762860E+07,1.68334359E+05,2.53444763E+02,
		154.387100,4.44058470E+09,3.40250016E+08,2.56464512E+08,2.95701120E+08,1.68059660E+07,1.47070719E+05,2.62487549E+02,
		158.381958,3.23383782E+09,2.86423488E+08,2.09704368E+08,2.58996000E+08,1.23041190E+07,1.29538164E+05,2.70057526E+02,
		162.480194,2.38507366E+09,2.40024656E+08,1.72393936E+08,2.21772208E+08,9.06723800E+06,1.14758938E+05,2.76364349E+02,
		166.684479,1.77302336E+09,2.00106144E+08,1.42259936E+08,1.88328576E+08,6.71175550E+06,1.02069453E+05,2.81593109E+02,
		170.997635,1.32352346E+09,1.66066512E+08,1.17680992E+08,1.64507968E+08,4.98267250E+06,9.10079219E+04,2.85906586E+02,
		175.422318,9.89464512E+08,1.37315088E+08,9.74773760E+07,1.46090736E+08,3.70544475E+06,8.12472188E+04,2.89446716E+02,
		179.961487,7.39430976E+08,1.13215408E+08,8.07712000E+07,1.30382064E+08,2.75778075E+06,7.25509766E+04,2.92337158E+02,
		184.618103,5.51600192E+08,9.31244880E+07,6.68975200E+07,1.16529000E+08,2.05256525E+06,6.47464883E+04,2.94684601E+02,
		189.395218,4.10319840E+08,7.64357760E+07,5.53429880E+07,1.04179616E+08,1.52684262E+06,5.77057383E+04,2.96580780E+02,
		194.295944,3.04108288E+08,6.26060120E+07,4.57043000E+07,9.31114240E+07,1.13461088E+06,5.13324961E+04,2.98103943E+02,
		199.323578,2.24408928E+08,5.11645360E+07,3.76592280E+07,8.31577440E+07,8.41955000E+05,4.55530156E+04,2.99320648E+02,
		204.481201,1.64782768E+08,4.17128560E+07,3.09470860E+07,7.41872640E+07,6.23727000E+05,4.03099375E+04,3.00286926E+02,
		209.772293,1.20344128E+08,3.39162160E+07,2.53534400E+07,6.60925880E+07,4.61164188E+05,3.55568242E+04,3.01049835E+02,
		215.200287,8.73762320E+07,2.74957360E+07,2.07005280E+07,5.87846000E+07,3.40240750E+05,3.12552266E+04,3.01648590E+02,
		220.768738,6.30453360E+07,2.22191680E+07,1.68395200E+07,5.21876680E+07,2.50446344E+05,2.73719922E+04,3.02115631E+02,
		226.481277,4.51917400E+07,1.78930440E+07,1.36449940E+07,4.62364920E+07,1.83898719E+05,2.38775254E+04,3.02477692E+02,
		232.341736,3.21721200E+07,1.43558800E+07,1.10106980E+07,4.08736320E+07,1.34685328E+05,2.07444727E+04,3.02756592E+02,
		238.353729,2.27406780E+07,1.14728880E+07,8.84651100E+06,3.60481760E+07,9.83766562E+04,1.79471367E+04,3.02970032E+02,
		244.521286,1.59558990E+07,9.13111900E+06,7.07564600E+06,3.17139000E+07,7.16539609E+04,1.54606152E+04,3.03132324E+02,
		250.848434,1.11105480E+07,7.23607750E+06,5.63283600E+06,2.78287520E+07,5.20370234E+04,1.32607783E+04,3.03254883E+02,
		257.339325,7.67634550E+06,5.70868350E+06,4.46262400E+06,2.43540740E+07,3.76750625E+04,1.13240928E+04,3.03346832E+02,
		263.998138,5.26131700E+06,4.48285000E+06,3.51800775E+06,2.12541580E+07,2.71899355E+04,9.62766211E+03,3.03415283E+02,
		270.829376,3.57660150E+06,3.50340950E+06,2.75923100E+06,1.84957760E+07,1.95573574E+04,8.14924512E+03,3.03465942E+02,
		277.837280,2.41107500E+06,2.72450875E+06,2.15285250E+06,1.60481620E+07,1.40184033E+04,6.86750830E+03,3.03503143E+02,
		285.026489,1.61153075E+06,2.10807775E+06,1.67079625E+06,1.38825550E+07,1.00115586E+04,5.76202148E+03,3.03530243E+02,
		292.401764,1.06777600E+06,1.62266488E+06,1.28963162E+06,1.19721920E+07,7.12268652E+03,4.81345850E+03,3.03549866E+02,
		299.967834,7.01239750E+05,1.24240050E+06,9.89906812E+05,1.02922320E+07,5.04717578E+03,4.00372412E+03,3.03563934E+02,
		307.729858,4.56376219E+05,9.46081125E+05,7.55543688E+05,8.81955900E+06,3.56147168E+03,3.31598950E+03,3.03573975E+02,
		315.692566,2.94299281E+05,7.16443688E+05,5.73351312E+05,7.53287700E+06,2.50212598E+03,2.73482568E+03,3.03581055E+02,
		323.861328,1.88015312E+05,5.39471750E+05,4.32543969E+05,6.41243950E+06,1.74983594E+03,2.24613110E+03,3.03586029E+02,
		332.241455,1.18978547E+05,4.03866781E+05,3.24372219E+05,5.44011150E+06,1.21788379E+03,1.83718933E+03,3.03589478E+02,
		340.838409,7.45674297E+04,3.00566375E+05,2.41778109E+05,4.59926450E+06,8.43422913E+02,1.49661707E+03,3.03591888E+02,
		349.657837,4.62772969E+04,2.22344078E+05,1.79104219E+05,3.87470950E+06,5.81065796E+02,1.21430994E+03,3.03593506E+02,
		358.705627,2.84352148E+04,1.63471781E+05,1.31845297E+05,3.25262100E+06,3.98156006E+02,9.81370422E+02,3.03594604E+02,
		367.987366,1.72964570E+04,1.19439617E+05,9.64394922E+04,2.72050025E+06,2.71297363E+02,7.90036987E+02,3.03595367E+02,
		377.509277,1.04136123E+04,8.67145312E+04,7.00859688E+04,2.26703750E+06,1.83785309E+02,6.33567871E+02,3.03595856E+02,
		387.277588,6.20475830E+03,6.25497656E+04,5.05999648E+04,1.88208162E+06,1.23754639E+02,5.06163177E+02,3.03596191E+02,
		397.298645,3.65817676E+03,4.48232500E+04,3.62885938E+04,1.55655188E+06,8.28156891E+01,4.02864380E+02,3.03596405E+02,
		407.579010,2.13381836E+03,3.19064277E+04,2.58492734E+04,1.28235900E+06,5.50655746E+01,3.19458954E+02,3.03596527E+02,
		418.125610,1.23122058E+03,2.25580352E+04,1.82868906E+04,1.05232675E+06,3.63729782E+01,2.52390015E+02,3.03596619E+02,
		428.944885,7.02665344E+02,1.58392236E+04,1.28472266E+04,8.60134312E+05,2.38636494E+01,1.98677063E+02,3.03596680E+02,
		440.044098,3.96579315E+02,1.10440557E+04,8.96216504E+03,7.00214875E+05,1.55479650E+01,1.55829910E+02,3.03596710E+02,
		451.430542,2.21319458E+02,7.64611621E+03,6.20738916E+03,5.67703938E+05,1.00580397E+01,1.21783913E+02,3.03596741E+02,
		463.111603,1.22112244E+02,5.25567334E+03,4.26833057E+03,4.58369219E+05,6.45928812E+00,9.48357849E+01,3.03596741E+02,
		475.094910,6.66025772E+01,3.58631641E+03,2.91353491E+03,3.68543688E+05,4.11734533E+00,7.35872192E+01,3.03596771E+02,
		487.388550,3.59048157E+01,2.42916187E+03,1.97402600E+03,2.95065250E+05,2.60459018E+00,5.68958282E+01,3.03596771E+02,
		500.000000,1.91293736E+01,1.63312292E+03,1.32747058E+03,2.35225828E+05,1.63491213E+00,4.38340759E+01,3.03596771E+02,
	};


	double VikingData[64*8] =
	{
		100.000000,1.46446955E+12,4.14429716E+10,7.21056922E+09,4.16562688E+09,4.88096051E+09,2.23635300E+06,1.19161179E+02,
		102.587570,9.62070315E+11,2.87473459E+10,5.37943910E+09,3.28939034E+09,3.25597594E+09,1.83398062E+06,1.19594139E+02,
		105.242096,6.26386534E+11,1.88761477E+10,3.98655795E+09,2.58661043E+09,2.15285862E+09,1.49511700E+06,1.20559593E+02,
		107.965302,4.05631238E+11,1.18360781E+10,2.94235443E+09,2.02921050E+09,1.41479386E+09,1.21370788E+06,1.22256866E+02,
		110.759026,2.62479299E+11,7.33506816E+09,2.17043994E+09,1.59208806E+09,9.27425088E+08,9.83453062E+05,1.24916954E+02,
		113.624992,1.70614997E+11,4.68990976E+09,1.60653376E+09,1.25273190E+09,6.08900480E+08,7.97556000E+05,1.28800079E+02,
		116.565117,1.11933170E+11,3.16300928E+09,1.19756608E+09,9.91043968E+08,4.01874368E+08,6.48872062E+05,1.34179001E+02,
		119.581314,7.43000965E+10,2.24145203E+09,9.00784256E+08,7.89342848E+08,2.67134848E+08,5.30233938E+05,1.41280533E+02,
		122.675560,4.97733960E+10,1.64270438E+09,6.82475968E+08,6.32299840E+08,1.78486864E+08,4.34733312E+05,1.50125961E+02,
		125.849869,3.32664443E+10,1.22225920E+09,5.16556416E+08,5.06836800E+08,1.18831576E+08,3.55951719E+05,1.60155502E+02,
		129.106384,2.18252370E+10,9.09619136E+08,3.86330080E+08,4.04303296E+08,7.79253920E+07,2.89684500E+05,1.69611526E+02,
		132.447098,1.45172705E+10,6.89620032E+08,2.93418112E+08,3.28242432E+08,5.17559960E+07,2.39400453E+05,1.77223648E+02,
		135.874252,9.80227174E+09,5.31134304E+08,2.26413168E+08,2.71136160E+08,3.48327120E+07,2.00764922E+05,1.83265579E+02,
		139.390091,6.68081408E+09,4.13160288E+08,1.76613984E+08,2.26879808E+08,2.36336300E+07,1.70090703E+05,1.88031937E+02,
		142.996887,4.57696512E+09,3.23316832E+08,1.38756880E+08,1.91707792E+08,1.61046020E+07,1.45102453E+05,1.91768539E+02,
		146.697037,3.14188826E+09,2.53807728E+08,1.09491120E+08,1.63185776E+08,1.09902130E+07,1.24332844E+05,1.94679214E+02,
		150.492981,2.15575603E+09,1.99454224E+08,8.65899680E+07,1.39677744E+08,7.49458850E+06,1.06801047E+05,1.96931763E+02,
		154.387100,1.47559795E+09,1.56661472E+08,6.85169760E+07,1.20047040E+08,5.09849000E+06,9.18306094E+04,1.98663361E+02,
		158.381958,1.00606266E+09,1.22838448E+08,5.41749840E+07,1.03479024E+08,3.45548850E+06,7.89403047E+04,1.99985443E+02,
		162.480194,6.82384960E+08,9.60612560E+07,4.27577560E+07,8.93747680E+07,2.33075950E+06,6.77782422E+04,2.00987885E+02,
		166.684479,4.59983136E+08,7.48656000E+07,3.36576280E+07,7.72835360E+07,1.56333262E+06,5.80796523E+04,2.01742569E+02,
		170.997635,3.07891744E+08,5.81140880E+07,2.64064840E+07,6.68585600E+07,1.04205881E+06,4.96391484E+04,2.02306641E+02,
		175.422318,2.04505072E+08,4.49107640E+07,2.06377960E+07,5.78288600E+07,6.89946125E+05,4.22931367E+04,2.02725098E+02,
		179.961487,1.34711472E+08,3.45406520E+07,1.60600430E+07,4.99783320E+07,4.53585375E+05,3.59067617E+04,2.03033218E+02,
		184.618103,8.79598800E+07,2.64300040E+07,1.24394690E+07,4.31329320E+07,2.96013062E+05,3.03663496E+04,2.03258347E+02,
		189.395218,5.69059480E+07,2.01164100E+07,9.58729400E+06,3.71508040E+07,1.91732672E+05,2.55737617E+04,2.03421539E+02,
		194.295944,3.64636560E+07,1.52268100E+07,7.35051450E+06,3.19153700E+07,1.23246734E+05,2.14427246E+04,2.03538895E+02,
		199.323578,2.31335340E+07,1.14604390E+07,5.60491650E+06,2.73299740E+07,7.86206484E+04,1.78962695E+04,2.03622589E+02,
		204.481201,1.45270480E+07,8.57573700E+06,4.24982950E+06,2.33142800E+07,4.97746328E+04,1.48653760E+04,2.03681793E+02,
		209.772293,9.02689000E+06,6.37911300E+06,3.20367250E+06,1.98005840E+07,3.12775996E+04,1.22874395E+04,2.03723312E+02,
		215.200287,5.54891900E+06,4.71642700E+06,2.40066900E+06,1.67316860E+07,1.95113516E+04,1.01058545E+04,2.03752182E+02,
		220.768738,3.37346350E+06,3.46556450E+06,1.78797600E+06,1.40586560E+07,1.20856064E+04,8.26939746E+03,2.03772064E+02,
		226.481277,2.02783762E+06,2.53037575E+06,1.32336000E+06,1.17391410E+07,7.43530957E+03,6.73185742E+03,2.03785645E+02,
		232.341736,1.20495325E+06,1.83562062E+06,9.73247438E+05,9.73588700E+06,4.54484570E+03,5.45171289E+03,2.03794846E+02,
		238.353729,7.07605062E+05,1.32284425E+06,7.11128562E+05,8.01571550E+06,2.76120215E+03,4.39193506E+03,2.03800995E+02,
		244.521286,4.10570594E+05,9.46874688E+05,5.16175531E+05,6.54840750E+06,1.66804749E+03,3.51959082E+03,2.03805084E+02,
		250.848434,2.35319359E+05,6.73075812E+05,3.72150594E+05,5.30618300E+06,1.00238367E+03,2.80567212E+03,2.03807785E+02,
		257.339325,1.33197609E+05,4.75061750E+05,2.66477000E+05,4.26321350E+06,5.99459412E+02,2.22479126E+03,2.03809525E+02,
		263.998138,7.44393594E+04,3.32872219E+05,1.89482766E+05,3.39537100E+06,3.56915924E+02,1.75490356E+03,2.03810654E+02,
		270.829376,4.10644922E+04,2.31508609E+05,1.33780562E+05,2.68008100E+06,2.11645340E+02,1.37699707E+03,2.03811371E+02,
		277.837280,2.23558691E+04,1.59789188E+05,9.37739141E+04,2.09638638E+06,1.25034569E+02,1.07483313E+03,2.03811829E+02,
		285.026489,1.20079902E+04,1.09430961E+05,6.52502812E+04,1.62493200E+06,7.36082535E+01,8.34617737E+02,2.03812119E+02,
		292.401764,6.36200977E+03,7.43477188E+04,4.50649531E+04,1.24808788E+06,4.31867485E+01,6.44739990E+02,2.03812286E+02,
		299.967834,3.32399414E+03,5.01020625E+04,3.08886855E+04,9.50023750E+05,2.52528133E+01,4.95504120E+02,2.03812393E+02,
		307.729858,1.71219348E+03,3.34829727E+04,2.10089453E+04,7.16726438E+05,1.47146702E+01,3.78867157E+02,2.03812469E+02,
		315.692566,8.69314514E+02,2.21873887E+04,1.41776719E+04,5.36018375E+05,8.54248428E+00,2.88219543E+02,2.03812500E+02,
		323.861328,4.34928497E+02,1.45755488E+04,9.49164062E+03,3.97463562E+05,4.93922758E+00,2.18156586E+02,2.03812531E+02,
		332.241455,2.14371857E+02,9.49092383E+03,6.30313086E+03,2.92283875E+05,2.84307504E+00,1.64299271E+02,2.03812531E+02,
		340.838409,1.04068146E+02,6.12471436E+03,4.15137354E+03,2.13210234E+05,1.62836659E+00,1.23122543E+02,2.03812546E+02,
		349.657837,4.97459030E+01,3.91639160E+03,2.71136304E+03,1.54317984E+05,9.27483976E-01,9.18088379E+01,2.03812546E+02,
		358.705627,2.34084053E+01,2.48106006E+03,1.75582275E+03,1.10851070E+05,5.25037766E-01,6.81213531E+01,2.03812546E+02,
		367.987366,1.08408442E+01,1.55696277E+03,1.12723840E+03,7.90485781E+04,2.95223713E-01,5.02973404E+01,2.03812546E+02,
		377.509277,4.93986559E+00,9.67694092E+02,7.17342651E+02,5.59737305E+04,1.64787561E-01,3.69548569E+01,2.03812561E+02,
		387.277588,2.21420407E+00,5.95593872E+02,4.52427368E+02,3.93653008E+04,9.12553966E-02,2.70186787E+01,2.03812561E+02,
		397.298645,9.76026893E-01,3.62952545E+02,2.82759583E+02,2.75029785E+04,5.01089878E-02,1.96572075E+01,2.03812561E+02,
		407.579010,4.22996968E-01,2.18963577E+02,1.75091293E+02,1.90929453E+04,2.72691585E-02,1.42311554E+01,2.03812561E+02,
		418.125610,1.80188566E-01,1.30751877E+02,1.07403282E+02,1.31726406E+04,1.46999098E-02,1.02520084E+01,2.03812561E+02,
		428.944885,7.54290074E-02,7.72724152E+01,6.52551575E+01,9.03361230E+03,7.84632657E-03,7.34892702E+00,2.03812561E+02,
		440.044098,3.10209710E-02,4.51892433E+01,3.92627106E+01,6.15889648E+03,4.14523296E-03,5.24166393E+00,2.03812561E+02,
		451.430542,1.25305159E-02,2.61467304E+01,2.33904762E+01,4.17499219E+03,2.16672826E-03,3.71987081E+00,2.03812561E+02,
		463.111603,4.97019989E-03,1.49662161E+01,1.37948217E+01,2.81431128E+03,1.12019025E-03,2.62652516E+00,2.03812561E+02,
		475.094910,1.93537015E-03,8.47343159E+00,8.05255032E+00,1.88667151E+03,5.72640449E-04,1.84505153E+00,2.03812561E+02,
		487.388550,7.39649171E-04,4.74455500E+00,4.65163851E+00,1.25794446E+03,2.89368560E-04,1.28937995E+00,2.03812561E+02,
		500.000000,2.77379295E-04,2.62708497E+00,2.65865541E+00,8.34268982E+02,1.44512655E-04,8.96352947E-01,2.03812561E+02,
	};


	ublas::matrix<double> MarinerConditions()
	{
		return PointerToMatrix(&(MarinerData[0]),64,8);
	}

	ublas::matrix<double> VikingConditions()
	{
		return PointerToMatrix(&(VikingData[0]),64,8);
	}


	std::deque< ublas::vector<double> > MarinerNeutralAtmo(const ublas::vector<double>& vAltitudeGridKm)
	{
		unsigned mdim=64;
		ublas::vector<double> tmpalt(vAltitudeGridKm.size());
		tmpalt.clear();
		deque< ublas::vector<double> > atmo_resu;//(6,tmpalt);
		ublas::vector<double> altim(mdim),tmpsp(mdim);
		altim.clear();
		tmpsp.clear();

		ublas::matrix<double> mariner=MarinerConditions();
		ublas::matrix_column< ublas::matrix<double> > ro(mariner,0);
		altim=ro;
		for(unsigned i=1;i<7;++i)
		{

			ublas::matrix_column< ublas::matrix<double> > ro2(mariner,i);
			tmpsp=ro2;

			atmo_resu.push_back(MathFunction::IntLog(altim,tmpsp,vAltitudeGridKm));
		}
	//	Log::mL<<"mariner atmosphere :"<<atmo_resu[1]<<endl;
		return atmo_resu;
	}
	std::deque< ublas::vector<double> > VikingNeutralAtmo(const ublas::vector<double>& vAltitudeGridKm)
	{
		unsigned mdim=64;
		ublas::vector<double> tmpalt(vAltitudeGridKm.size());
		tmpalt.clear();
		deque< ublas::vector<double> > atmo_resu;
		ublas::vector<double> altim(mdim),tmpsp(mdim);
		altim.clear();
		tmpsp.clear();

		ublas::matrix<double> viking=VikingConditions();

		ublas::matrix_column< ublas::matrix<double> > ro(viking,0);
		altim=ro;
		for(unsigned i=1;i<7;++i)
		{

			ublas::matrix_column< ublas::matrix<double> > ro2(viking,i);
			tmpsp=ro2;

			atmo_resu.push_back(MathFunction::IntLog(altim,tmpsp,vAltitudeGridKm));
		}
		return atmo_resu;
	}

	ublas::vector<double>  MarinerNTemp(const ublas::vector<double>& vAltitudeGridKm)
	{
		unsigned mdim=64;
		ublas::vector<double> altim(mdim),tmpsp(mdim);
		altim.clear();
		tmpsp.clear();

		ublas::matrix<double> mariner=MarinerConditions();
		// Smarter solution should exists... This one works
	/*	for(unsigned k=0;k<mdim;++k)
		{
			altim[k]=mariner(0,k);
		}
		for(unsigned k=0;k<mdim;++k)
		{
			tmpsp[k]=mariner(7,k);
		}
		*/
		ublas::matrix_column< ublas::matrix<double> > ro(mariner,0);
		altim=ro;
		ublas::matrix_column< ublas::matrix<double> > ro2(mariner,7);
		tmpsp=ro2;
		return MathFunction::IntLog(altim,tmpsp,vAltitudeGridKm);
	}

	ublas::vector<double>  VikingNTemp(const ublas::vector<double>& vAltitudeGridKm)
	{
		unsigned mdim=64;
		ublas::vector<double> altim(mdim),tmpsp(mdim);
		altim.clear();
		tmpsp.clear();

		ublas::matrix<double> viking=VikingConditions();
		// Smarter solution should exists... This one works
/*		for(unsigned k=0;k<mdim;++k)
		{
			altim[k]=viking(0,k);
		}
		for(unsigned k=0;k<mdim;++k)
		{
			tmpsp[k]=viking(7,k);
		}*/
		ublas::matrix_column< ublas::matrix<double> > ro(viking,0);
		altim=ro;
		ublas::matrix_column< ublas::matrix<double> > ro2(viking,7);
		tmpsp=ro2;
		return MathFunction::IntLog(altim,tmpsp,vAltitudeGridKm);
	}
};


